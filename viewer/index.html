<html lang="en" data-color-mode="auto" data-light-theme="light" data-dark-theme="dark"><head><meta charset="utf-8"><script type="module" src="/index.a1e7b7df.js"></script></head><body> <h1>Retrieve Data for SMART Health Link</h1> <div> <input id="clientNameInput" value="Example SHL Client"><br> <input id="shlInput" autofocus placeholder="Paste SMART Health Link" onkeyup="processInput()"> <input class="hidden" id="pinInput" placeholder="Enter PIN" style="width:5rem;opacity:20%" onkeyup="processInput()"> <br> <div id="result"> </div> <script>const clientNameText=document.getElementById("clientNameInput"),shlText=document.getElementById("shlInput"),pinText=document.getElementById("pinInput"),result=document.getElementById("result"),linkInUrl=window.location.hash.match(/shlink:\/.*/);async function processInput(){if(await shl.needPin({shl:shlText.value})){if(pinText.setAttribute("style","width: 5rem; opacity: 100%;"),""===pinText.value)return void pinText.focus()}else pinText.setAttribute("style","width: 5rem; opacity: 20%");console.log("Connect",shlText.value,pinText.value);const e=await shl.connect({shl:shlText.value,pin:pinText.value,clientName:clientNameText.value}),t=await shl.pull(e);console.log("Connected",t),result.innerHTML=`\n        <div>\n          ${t.shcs.length} Health Cards retrieved for \n          <pre>${JSON.stringify(t.shcs[0].decoded.vc.credentialSubject.fhirBundle.entry[0].resource,null,2)}</pre>\n          <h2>Details</h2>\n          <ul>\n            ${t.shcs.flatMap((e=>e.decoded.vc.credentialSubject.fhirBundle.entry.slice(1))).map((e=>e.resource)).map((e=>`<li><pre>${JSON.stringify(e,null,2)}</pre></li>`)).join(" ")}\n          </ul>\n        </div>`}linkInUrl&&(shlInput.value=linkInUrl[0]);</script> </div></body></html>